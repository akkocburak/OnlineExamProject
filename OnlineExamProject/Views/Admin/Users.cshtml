@model IEnumerable<OnlineExamProject.Models.User>

@{
    ViewData["Title"] = "Kullanıcı Yönetimi";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h2>Kullanıcı Yönetimi</h2>
            <hr>
            
            @if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success">@TempData["SuccessMessage"]</div>
            }
            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
            }

            <div class="mb-3">
                <a asp-action="CreateUser" class="btn btn-success">
                    <i class="fas fa-user-plus"></i> Yeni Kullanıcı Ekle
                </a>
                <a asp-action="Index" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Admin Paneli
                </a>
            </div>

            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs">
                        <li class="nav-item">
                            <a class="nav-link @(ViewBag.Role == "" ? "active" : "")" asp-action="Users">Tümü</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewBag.Role == "Student" ? "active" : "")" asp-action="Users" asp-route-role="Student">Öğrenciler</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewBag.Role == "Teacher" ? "active" : "")" asp-action="Users" asp-route-role="Teacher">Öğretmenler</a>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    @if (Model != null && Model.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Ad Soyad</th>
                                        <th>E-posta</th>
                                        <th>Rol</th>
                                        <th>Bölüm</th>
                                        <th>Sınıf</th>
                                        <th>İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var user in Model)
                                    {
                                        <tr>
                                            <td>@user.FullName</td>
                                            <td>@user.Email</td>
                                            <td>
                                                <span class="badge bg-@(user.Role == "Student" ? "primary" : user.Role == "Teacher" ? "success" : "danger")">
                                                    @user.Role
                                                </span>
                                            </td>
                                            <td>@(user.Department ?? "-")</td>
                                            <td>@(user.Class ?? "-")</td>
                                            <td>
                                                <a asp-action="EditUser" asp-route-id="@user.UserId" class="btn btn-sm btn-primary">
                                                    <i class="fas fa-edit"></i> Düzenle
                                                </a>
                                                <form asp-action="DeleteUser" method="post" style="display: inline;" onsubmit="return confirm('Bu kullanıcıyı silmek istediğinizden emin misiniz?');">
                                                    <input type="hidden" name="id" value="@user.UserId" />
                                                    <button type="submit" class="btn btn-sm btn-danger">
                                                        <i class="fas fa-trash"></i> Sil
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-info">Kullanıcı bulunamadı.</div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>



